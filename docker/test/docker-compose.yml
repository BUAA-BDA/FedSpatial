version: '3.3'

services:
  postgres_1:
    image: postgres
    restart: "no"
    container_name: postgres_1
    ports:
      - 13101:5432
    environment:
      POSTGRES_PASSWORD: onedb
    volumes:
      - ./db/db1.sql:/docker-entrypoint-initdb.d/init.sql

  postgres_2:
    image: postgres
    restart: "no"
    container_name: postgres_2
    ports:
      - 13102:5432
    environment:
      POSTGRES_PASSWORD: onedb
    volumes:
      - ./db/db2.sql:/docker-entrypoint-initdb.d/init.sql

  postgres_3:
    image: postgres
    restart: "no"
    container_name: postgres_3
    ports:
      - 13103:5432
    environment:
      POSTGRES_PASSWORD: onedb
    volumes:
      - ./db/db3.sql:/docker-entrypoint-initdb.d/init.sql

  builder:
    image: maven:3.8-openjdk-11
    container_name: builder
    restart: "no"
    working_dir: /root/code
    command: bash ./package.sh
    volumes:
      - ~/.m2:/root/.m2
      - $PWD/../..:/root/code
